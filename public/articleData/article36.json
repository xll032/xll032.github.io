{
  "title":"Grunt 工具的安装、配置及使用",
  "type":32,
  "time":"2016/12/08 14:44",
  "content":"<p>一、Grunt 的安装：</p><p>Grunt 是基于 Node.js 使用的，Grunt 0.4.x 必须配合 Node.js >= 0.8.0版本使用</p><p>确认安装好 Node.js 后可以开始安装 Grunt</p><p>如果之前安装了老版本的 Grunt 的话，需要先将老版本卸载</p>卸载 Grunt 的命令：<pre class='cmd'>-- npm uninstall -g grunt</pre><p>安装 Grunt 的命令如下：</p><pre class='cmd'>-- npm install -g grunt-cli</pre><p>-g 代表全局安装，grunt 有两个版本：服务器版本（grunt）和客户端版本（grunt-cli）。</p><p>值得一提的是，安装 grunt-cli 并不等于安装了 grunt。</p><p>grunt CLI 的任务很简单：调用与Gruntfile在同一目录中的 grunt。</p><p>这样带来的好处是可以在同一个系统上安装多个版本的 grunt。</p><p>grunt 使用模块结构，除了安装命令行界面以外，还要根据需要安装相应的模块这些模块应该采用局部安装，因为不同项目可能需要同一个模块的不同版本</p><p>配置完成，并且完成模块的安装才算真正完成了 Grunt 的安装，并可以开始使用。</p><p>二、Grunt 文件的配置</p><p>Grunt 安装之后，可以使用 grunt 命令进行操作，进行文件的配置：</p><p>1、在目录下创建项目文件夹，并进入文件夹（下面的操作在目录下用 Windows 的新建文件夹效果一样，ProjectName 就是文件名）</p><pre class='cmd'>-- mkdir ProjectName<br>-- cd ProjectName</pre><p>2、在项目文件夹的根目录下添加两个文件 package.json 和 Gruntfile.js</p><p>这两个文件命名及作用的说明：</p><p>&nbsp;&nbsp;&nbsp;&nbsp;package.json&nbsp;&nbsp;&nbsp;&nbsp;此文件被 npm 用于存储项目的元数据，以便将此项目发布为 npm 模块（我也不知道具体干嘛的）</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Gruntflie.js&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此文件可被命名为 Gruntfile.js 或 Gruntfile.coffee，用来配置或定义任务（task）并加载 Grunt 插件</p><p>（1）创建 package.json</p><p>&nbsp;&nbsp;&nbsp;&nbsp;可以用 npm init 命令创建（根据提示填写信息，都允许为空），也可以手动创建这个文件。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;文档内容示例（随便写的值，不一定对，推荐用 npm init 命令去创建）：</p><pre class='code'><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>name</span><span class='word'>:</span> <span class='str'>\"GruntDemo\"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 模块名称：只能包含小写字母数字和中划线，如果为空则使用项目文件夹名称代替</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>version</span><span class='word'>:</span> <span class='str'>\"0.0.0\"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 版本号</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>description</span><span class='word'>:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 描述：会在npm搜索列表中显示</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>entry point</span><span class='word'>:</span> <span class='str'>\"index.js\"</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 模块入口文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>test command</spam><span class='word'>:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 测试脚本</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>git repository</span><span class='word'>:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// git仓库地址</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>keywords</span><span class='word'>:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 关键字：用于npm搜索，多个关键字用空格分开</span><br>&nbsp;&nbsp;&nbsp;&nbsp;author:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 作者</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>license</span><span class='word'>:</span> <span class='str'>\"BSD-2-Clause\"&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 开源协议</span><br>}</pre><p>更多的配置参数可参考官方网站：<a href='https://docs.npmjs.com/files/package.json' target='_blank'>package.json 官方文档</a></p><p>（2）Gruntfile.js 配置</p><p>Gruntfile.js 主要有三块内容：任务配置代码；插件加载代码；任务注册代码。具体的划分及作用见下面示例。</p><p>简单的配置示例：（更复杂的可参考官方API研究）</p><pre class='code'><span class='spe'>module</span><span class='word'>.</span><span class='spe'>exports</span> <span class='key'>=</span> <span class='key'>function</span><span class='word'>(grunt)</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 配置任务参数（任务配置代码，写在 grunt.initConfig() 中）</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='spe'>grunt</span><span class='word'>.</span><span class='spe'>initConfig</span><span class='word'>(</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>pkg</span><span class='word'>:</span><span class='spe'>grunt</span><span class='word'>.</span><span class='spe'>file</span><span class='word'>.</span><span class='spe'>readJSON</span><span class='word'>(</span><span class='str'>'package.json'</span><span class='word'>), </span><span class='com'>// 读取 package.json 文件，并获取信息，方便后面的任务应用，提高灵活性</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>cssmin</span><span class='word'>:</span><span class='flower'>{ </span><span class='com'>// 这个变量名是要使用的模块，名字是固定的，对应的参数也固定。使用不同的模块需要去查看文档上的说明</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>combine</span><span class='word'>:</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>files</span><span class='word'>:</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='spe'>'css/demo.css'</span><span class='word'>:</span><span class='rect'>[</span><span class='str'>'css/*.css'</span><span class='rect'>]</span> <span class='com'>// 合并指定文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><span class='word'>,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>minify</span><span class='word'>:</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>options</span><span class='word'>:</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>keepSpecialComments</span><span class='word'>:</span><span class='word'>0,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>banner</span><span class='word'>:</span><span class='str'>'/* minified css file */'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><span class='word'>,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='fun'>files</span><span class='word'>:</span><span class='flower'>{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='spe'>'css/master.min.css'</span><span class='word'>:</span><span class='rect'>[</span><span class='str'>'css/master.css'</span><span class='rect'>]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='flower'>}</span><span class='word'>);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>//插件加载（加载 cssmin 模块）</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='spe'>grunt</span><span class='word'>.</span><span class='method'>loadNpmTasks</span><span class='word'>(</span><span class='str'>'grunt-contrib-cssmin'</span><span class='word'>);</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='com'>// 注册任务。自定义任务：通过定义 default 任务，可以让 Grunt 默认执行一个或多个任务</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class='spe'>grunt</span><span class='word'>.</span><span class='method'>registerTask</span><span class='word'>(</span><span class='str'>'default'</span><span class='word'>,</span><span class='rect'>[</span><span class='str'>'cssmin'</span><span class='rect'>]</span><span class='word'>);</span><br><span class='flower'>}</span></pre><p>3、安装Grunt 及所需的模块</p><p>配置文件和使用的模块都是必须的，配置完成之后，安装完模块，就能正常使用了。</p><p>（1）首先安装最新版的 Grunt</p><pre class='cmd'>-- npm install grunt --save-dev</pre><p>（2）然后安装所需的 Grunt 组件</p><pre class='cmd'>-- npm install grunt-contrib-mincss --save-dev</pre><p>（3）如果需要安装指定版本的 Grunt 可以使用以下命令（@VERSION 是指定的版本号）</p><pre class='cmd'>-- npm install grunt@VERSION --save-dev</pre><p>（4）常用的 Grunt 组件安装命令</p><p>合并文件</p><pre class='cmd'>-- npm install grunt-contrib-concat --save-dev</pre><p>语法检查</p><pre class='cmd'>-- npm install grunt-contrib-jshint --save-dev</pre><p>Scss编译</p><pre class='cmd'>npm install grunt-contrib-sass --save-dev</pre><p>压缩 JS 文件</p><pre class='cmd'>-- npm install grunt-contrib-uglify --save-dev</pre><p>压缩 CSS 文件</p><pre class='cmd'>-- npm install grunt-cssmin-connect --save-dev</pre><p>监听文件变动</p><pre class='cmd'>-- npm install grunt-contrib-watch --save-dev</pre><p>建立本地服务器</p><pre class='cmd'>-- npm install grunt-contrib-connect --save-dev</pre><p>也可以多个任务同时安装（不知何种原因，我失败了，有可能写法不对，最后还是一个个装）</p><pre class='cmd'>-- npm install --save-dev grunt-contrib-concat grunt-contrib-jshint</pre><p>4、Grunt 的使用</p><p>做了大量的准备工作，现在可以开始使用啦。先进入到 Grunt 安装目录下（建议不要把 Grunt 路径安装的太深，不然每次使用路径就要输很多），执行 Grunt 命令（xxxx 是在 Gruntfile.js 中最后注册号的任务名，如果后面不写任务名，直接会执行所有注册过的任务）：</p><pre class='cmd'>-- grunt xxxx</pre><p>配置虽然麻烦了点，用起来是不是很方便？如果报错了可以根据提示看看问题出在哪里。一般会出现的问题是：配置文件写错了或者 Grunt 或 Grunt 模块安装出错了。</p>"
}